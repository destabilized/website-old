---
date: 2025-05-17
title: "soph week 5/12 - 5/16 (end of sumobot?)"
draft: false
categories: ["blog", "sumobot"]
---

blog post not required, but i did so much this week that i don't want to merge another week of work into this post.

sumobot competition in four more school days. 

### massive code changes
wanted to further simplify my code, even though it was already pretty simplified. also added a few things.

#### directional movements
previously, my code looked like this.
![website](/img/soph/8/directions.png)

while there is nothing wrong with this, it was quite cluttered with all the digitalwrites, so i decided to simplify it.

using a function to control the motors, i was able to set a value (high or low) to each motor without having to continuously write "digitalwrite(motor____, high/low).

in the end, my directional movement code ended up looking like this while utilizing a few functions:
<div style="display: flex;">  
  <img style="width: 90%;" src="/img/soph/16/motor_code.png">
  <img style="width: 55%;" src="/img/soph/16/directions_code.png">
</div>

###### huge difference compared to original code. left side is the function, right side is passing the values to the function for each direction.

in addition, i got rid of my old star function and "startR" function as the right button for some reason didn't work. (probably cause i wired it wrong on my pcb).

#### button changes
since the right button was always "on" for some reason, i decided that it wasn't necessary, and just removed it. also, since my code for the buttons was all over the place, i decided to consolidate it into a single function. 

![website](/img/soph/16/button_handling.png)
###### keeping the same idea and attack pattern of the button, but consolidated. 

#### sensor changes
with my old code, when the sensors got activated, the motors moved backwards for a set amount of time. however, it sometimes wouldn't be enough time, and would end up moving forward too early / turning too early.

to fix this, we used a while loop and waited an extra second before starting the turn. in addition, more functions were created to further neaten up the code.

<div style="display: flex;">  
  <img style="width: 45%;" src="/img/soph/16/original_sen.png">
  <img style="width: 45%;" src="/img/soph/16/final_sen_code.png">
</div>

###### another comparison. left is previous code, right side is my updated code 

with all of these coding changes, my setup and loop was simplified drastically, now looking like this:
![website](/img/soph/16/setup+loop.png)

### testing shenanigans
we finally decided to get our sumobot assembled and i could finally test my code just to find some problems while testing. we encountered quite a bit of problems that we had to fix.

however, if anyone saw my pcb schematic that i made for the sumobot, you may have noticed that i don't have a common ground.

#### pcb problem
well, we all didn't notice this until we started to test the sumobot where we saw that the sumobot only got power when the lever roller switches weren't pressed down for some reason. despite this, it worked to some degree for some reason (probably using a digital pin on the metromini as ground?)

after some re-looking on the pcb document, we noticed this problem. however, rather than re-milling a pcb, we decided to just make a new trace for ground. 
![website](/img/soph/16/fixed_ground.jpeg)

with this fixed, we were able to get testing.

#### minor setback
one of the main issues that we wanted to address was the lack of turning by the sumobot. while this was a quick fix of changing the delays to allow the backwards(); function to further back up, i accidentally broke one of the two sumobots.

<div style="display: flex;">  
  <img style="width: 45%;" src="/img/soph/16/broken.jpeg">
  <img style="width: 45%;" src="/img/soph/16/broken2.jpeg">
</div>

for some reason, i just forgot to react or protect the bot in case it fell of the table, and it ended up falling off the table. 

while this was easily fixed by reprinting the base and re-cutting the acrylic piece, it was a minor setback, and i started testing code on the second sumobot that miles made.

#### testing problems cont.
problem no3.

right away, we noticed that one of the major problems was that the robot when crossing the white line (as the lever rollers can't detect color but rather when it isn't pressed), it was unable to bring itself back up.

<video width="640" height="360" controls>
  <source src="/vids/soph/16/problem.mp4" type="video/mp4">
</video>

me and miles spent quite a while debugging possible fixes to this problem, some of which included:
    - increasing the amount of times moving backwards off the edge
    - implementing a "bunnyhop" mechanism where it "jumps", detaching the switches from the edge.
    - adding a ramp to the sensors so it wouldn't get caught on the edge.
    
while the first two mechanisms didn't work, miles eventually noticed that due to the "90Â°" angle with the rollers, it wouldn't get back up as it was stuck in a perpendicular angle from the edge and the roller. to fix this, he suggested making a ramp to put onto the sensors to prevent it from getting jammed.

![website](/img/soph/16/improv.jpeg)
###### cardboard ramps to prevent jamming on the edge
we decided to just use cardboard for a quick fix. combined with some hot glue, this ended up working amazingly.

<video width="640" height="360" controls>
  <source src="/vids/soph/16/fixed.mp4" type="video/mp4">
</video>

finally, we wanted to not have a set amount of turning delay, as it led to predictable movements and the sumobot staying on one side of the arena.

#### turning fixes + problems
originally, i was going to use a random function to generate a random number for the delay value, something like this:
![website](/img/soph/16/turning_idea.png)

however, while setting this up in the sumobot i realized that every time the sumobot was run, the same values were showing up.

![website](/img/soph/16/turning_problems.png)

###### startL indicates that it has been rerun, and you can see that the same values show up.

this was because i had the seed where the random numbers would come from in the setup, where it would only change if it was re-uploaded. to fix this, i moved it to when the button gets pressed, which led to randomness every time like i wanted.

<div style="display: flex; align-items: flex-start;">  
  <img style="width: 640px; height: 360px;" src="/img/soph/16/turning_fix.png">
  <video style="width: 640px; height: 360px;" controls>
    <source src="/vids/soph/16/turning.mp4" type="video/mp4">
  </video>
</div>

###### random numbers this time. also used (5-16) * 100 cause there wasn't much difference between like 600 and 620

with all of this, i believe our sumobot is done. potentially gotta fix the problems where it gets stuck for a bit (if possible), but that's all.



### sumobot results
the orange bot (the one that miles claimed) got second, losing to [tims](https://timmy.greenlifestylelabs.com/) and [benji](https://benjismit.wordpress.com/) with their extremely fast, suicide bot.

while we are given an extra week to revamp and improve our bots (as a few didn't work as intended), we likely won't be continuing our bot, marking the end of this project...unless?

<video width="640" height="360" controls>
  <source src="/vids/soph/16/funny.mp4" type="video/mp4">
</video>

###### here's a funny moment

